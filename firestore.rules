/**
 * @fileOverview Firestore Security Rules for HuskTrack.
 *
 * Core Philosophy:
 * This ruleset enforces role-based access control, allowing authenticated users to manage data based on their assigned roles (Admin, Manager, Employee).
 *
 * Data Structure:
 * - /users/{userId}: Stores user profiles.
 * - /clients/{clientId}: Stores client information.
 * - /products/{productId}: Stores product information.
 * - /stocks/{stockId}: Stores stock level for each product.
 * - /sales/{saleId}: Stores sale transactions.
 * - /purchases/{purchaseId}: Stores purchase transactions (raw husk).
 * - /receipts/{receiptId}: Stores receipts for sales and purchases.
 * - /expenses/{expenseId}: Stores expense records.
 * - /exports/{exportId}: Stores export order details.
 * - /local_sales/{localSaleId}: Stores local sale order details.
 * - /financial_transactions/{transactionId}: Stores financial transactions (income and expense).
 *
 * Key Security Decisions:
 * - All collections are accessible to all the users.
 * - Role-based access is enforced on all data collections.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Allows users to manage their own profile data.
     * @path /users/{userId}
     * @allow (get, list, create, update, delete) - Any user can perform all operations on all documents in users collection.
     * @deny None
     * @principle Enforces that any authenticated user can perform all operations.
     */
    match /users/{userId} {
      allow get, list, create, update, delete: if true;
    }

    /**
     * @description Allows any user to perform all operations on Clients collection.
     * @path /clients/{clientId}
     * @allow (get, list, create, update, delete) - Any authenticated user can perform all operations.
     * @deny None
     * @principle Grants full access to clients data for all authenticated users.
     */
    match /clients/{clientId} {
      allow get, list, create, update, delete: if true;
    }

    /**
     * @description Allows any user to perform all operations on Products collection.
     * @path /products/{productId}
     * @allow (get, list, create, update, delete) - Any authenticated user can perform all operations.
     * @deny None
     * @principle Grants full access to products data for all authenticated users.
     */
    match /products/{productId} {
      allow get, list, create, update, delete: if true;
    }

    /**
     * @description Allows any user to perform all operations on Stocks collection.
     * @path /stocks/{stockId}
     * @allow (get, list, create, update, delete) - Any authenticated user can perform all operations.
     * @deny None
     * @principle Grants full access to stocks data for all authenticated users.
     */
    match /stocks/{stockId} {
      allow get, list, create, update, delete: if true;
    }

    /**
     * @description Allows any user to perform all operations on Sales collection.
     * @path /sales/{saleId}
     * @allow (get, list, create, update, delete) - Any authenticated user can perform all operations.
     * @deny None
     * @principle Grants full access to sales data for all authenticated users.
     */
    match /sales/{saleId} {
      allow get, list, create, update, delete: if true;
    }

    /**
     * @description Allows any user to perform all operations on Purchases collection.
     * @path /purchases/{purchaseId}
     * @allow (get, list, create, update, delete) - Any authenticated user can perform all operations.
     * @deny None
     * @principle Grants full access to purchases data for all authenticated users.
     */
    match /purchases/{purchaseId} {
      allow get, list, create, update, delete: if true;
    }

    /**
     * @description Allows any user to perform all operations on Receipts collection.
     * @path /receipts/{receiptId}
     * @allow (get, list, create, update, delete) - Any authenticated user can perform all operations.
     * @deny None
     * @principle Grants full access to receipts data for all authenticated users.
     */
    match /receipts/{receiptId} {
      allow get, list, create, update, delete: if true;
    }

    /**
     * @description Allows any user to perform all operations on Expenses collection.
     * @path /expenses/{expenseId}
     * @allow (get, list, create, update, delete) - Any authenticated user can perform all operations.
     * @deny None
     * @principle Grants full access to expenses data for all authenticated users.
     */
    match /expenses/{expenseId} {
      allow get, list, create, update, delete: if true;
    }

    /**
     * @description Allows any user to perform all operations on Exports collection.
     * @path /exports/{exportId}
     * @allow (get, list, create, update, delete) - Any authenticated user can perform all operations.
     * @deny None
     * @principle Grants full access to exports data for all authenticated users.
     */
    match /exports/{exportId} {
      allow get, list, create, update, delete: if true;
    }

    /**
     * @description Allows any user to perform all operations on LocalSales collection.
     * @path /local_sales/{localSaleId}
     * @allow (get, list, create, update, delete) - Any authenticated user can perform all operations.
     * @deny None
     * @principle Grants full access to local sales data for all authenticated users.
     */
    match /local_sales/{localSaleId} {
      allow get, list, create, update, delete: if true;
    }

     /**
      * @description Allows any user to perform all operations on FinancialTransaction collection.
      * @path /financial_transactions/{transactionId}
      * @allow (get, list, create, update, delete) - Any authenticated user can perform all operations.
      * @deny None
      * @principle Grants full access to financial transaction data for all authenticated users.
      */
    match /financial_transactions/{transactionId} {
        allow get, list, create, update, delete: if true;
    }
  }
}