{
  "entities": {
    "Client": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Client",
      "type": "object",
      "description": "Represents a client of SK Traders.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Client entity."
        },
        "companyName": {
          "type": "string",
          "description": "Name of the client's company."
        },
        "contactName": {
          "type": "string",
          "description": "Contact person's name at the client's company."
        },
        "contactEmail": {
          "type": "string",
          "description": "Contact person's email address.",
          "format": "email"
        },
        "contactPhone": {
          "type": "string",
          "description": "Contact person's phone number."
        },
        "address": {
          "type": "string",
          "description": "Client's company address."
        },
        "exportPreferences": {
          "type": "string",
          "description": "Client's export preferences (e.g., preferred port, shipping terms)."
        }
      },
      "required": [
        "id",
        "companyName",
        "contactName"
      ]
    },
    "Product": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Product",
      "type": "object",
      "description": "Represents a product offered by SK Traders (Coco Pith, Coir Fiber, Coconut Husk Chips).",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Product entity."
        },
        "name": {
          "type": "string",
          "description": "Name of the product."
        },
        "description": {
          "type": "string",
          "description": "Detailed description of the product."
        },
        "sellingPrice": {
          "type": "number",
          "description": "Selling price of the product."
        }
      },
      "required": [
        "id",
        "name",
        "sellingPrice"
      ]
    },
    "Stock": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Stock",
      "type": "object",
      "description": "Represents the stock levels of each product.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Stock entity."
        },
        "productId": {
          "type": "string",
          "description": "Reference to Product. (Relationship: Product 1:N Stock)"
        },
        "quantity": {
          "type": "number",
          "description": "Quantity of the product in stock."
        },
        "costPrice": {
          "type": "number",
          "description": "Cost price of the product."
        }
      },
      "required": [
        "id",
        "productId",
        "quantity",
        "costPrice"
      ]
    },
    "Sale": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Sale",
      "type": "object",
      "description": "Represents a sale transaction.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Sale entity."
        },
        "clientId": {
          "type": "string",
          "description": "Reference to Client. (Relationship: Client 1:N Sale)"
        },
        "productId": {
          "type": "string",
          "description": "Reference to Product. (Relationship: Product 1:N Sale)"
        },
        "quantity": {
          "type": "number",
          "description": "Quantity of the product sold."
        },
        "saleDate": {
          "type": "string",
          "description": "Date of the sale.",
          "format": "date-time"
        },
        "totalAmount": {
          "type": "number",
          "description": "Total amount of the sale."
        }
      },
      "required": [
        "id",
        "clientId",
        "productId",
        "quantity",
        "saleDate",
        "totalAmount"
      ]
    },
    "Purchase": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Purchase",
      "type": "object",
      "description": "Represents a purchase transaction (raw husk).",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Purchase entity."
        },
        "productId": {
          "type": "string",
          "description": "Reference to Product. (Relationship: Product 1:N Purchase)"
        },
        "quantity": {
          "type": "number",
          "description": "Quantity of the product purchased."
        },
        "purchaseDate": {
          "type": "string",
          "description": "Date of the purchase.",
          "format": "date-time"
        },
        "cost": {
          "type": "number",
          "description": "Cost of the purchase."
        }
      },
      "required": [
        "id",
        "productId",
        "quantity",
        "purchaseDate",
        "cost"
      ]
    },
    "Receipt": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Receipt",
      "type": "object",
      "description": "Represents a receipt for a sale or purchase.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Receipt entity."
        },
        "saleId": {
          "type": "string",
          "description": "Reference to Sale. (Relationship: Sale 1:N Receipt)"
        },
        "receiptDate": {
          "type": "string",
          "description": "Date of the receipt.",
          "format": "date-time"
        },
        "totalAmount": {
          "type": "number",
          "description": "Total amount on the receipt."
        },
        "taxAmount": {
          "type": "number",
          "description": "Tax amount on the receipt."
        }
      },
      "required": [
        "id",
        "saleId",
        "receiptDate",
        "totalAmount"
      ]
    },
    "Expense": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Expense",
      "type": "object",
      "description": "Represents an expense incurred by SK Traders.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Expense entity."
        },
        "description": {
          "type": "string",
          "description": "Description of the expense."
        },
        "amount": {
          "type": "number",
          "description": "Amount of the expense."
        },
        "expenseDate": {
          "type": "string",
          "description": "Date of the expense.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "description",
        "amount",
        "expenseDate"
      ]
    },
    "Export": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Export",
      "type": "object",
      "description": "Represents an export order.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Export entity."
        },
        "clientId": {
          "type": "string",
          "description": "Reference to Client (international buyer). (Relationship: Client 1:N Export)"
        },
        "productId": {
          "type": "string",
          "description": "Reference to Product. (Relationship: Product 1:N Export)"
        },
        "quantity": {
          "type": "number",
          "description": "Quantity of the product exported."
        },
        "exportDate": {
          "type": "string",
          "description": "Date of the export.",
          "format": "date-time"
        },
        "destinationCountry": {
          "type": "string",
          "description": "Destination country for the export."
        },
        "destinationPort": {
          "type": "string",
          "description": "Destination port for the export."
        },
        "invoiceNumber": {
          "type": "string",
          "description": "Invoice number for the export."
        }
      },
      "required": [
        "id",
        "clientId",
        "productId",
        "quantity",
        "exportDate",
        "destinationCountry",
        "destinationPort",
        "invoiceNumber"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/clients/{clientId}",
        "definition": {
          "entityName": "Client",
          "schema": {
            "$ref": "#/backend/entities/Client"
          },
          "description": "Stores client information. Each document represents a single client.",
          "params": [
            {
              "name": "clientId",
              "description": "The unique identifier for the client."
            }
          ]
        }
      },
      {
        "path": "/products/{productId}",
        "definition": {
          "entityName": "Product",
          "schema": {
            "$ref": "#/backend/entities/Product"
          },
          "description": "Stores product information. Each document represents a single product.",
          "params": [
            {
              "name": "productId",
              "description": "The unique identifier for the product."
            }
          ]
        }
      },
      {
        "path": "/stocks/{stockId}",
        "definition": {
          "entityName": "Stock",
          "schema": {
            "$ref": "#/backend/entities/Stock"
          },
          "description": "Stores stock information. Each document represents the stock level for a specific product.",
          "params": [
            {
              "name": "stockId",
              "description": "The unique identifier for the stock record."
            }
          ]
        }
      },
      {
        "path": "/sales/{saleId}",
        "definition": {
          "entityName": "Sale",
          "schema": {
            "$ref": "#/backend/entities/Sale"
          },
          "description": "Stores sales transaction information. Each document represents a single sale.",
          "params": [
            {
              "name": "saleId",
              "description": "The unique identifier for the sale transaction."
            }
          ]
        }
      },
      {
        "path": "/purchases/{purchaseId}",
        "definition": {
          "entityName": "Purchase",
          "schema": {
            "$ref": "#/backend/entities/Purchase"
          },
          "description": "Stores purchase transaction information (raw husk). Each document represents a single purchase.",
          "params": [
            {
              "name": "purchaseId",
              "description": "The unique identifier for the purchase transaction."
            }
          ]
        }
      },
      {
        "path": "/receipts/{receiptId}",
        "definition": {
          "entityName": "Receipt",
          "schema": {
            "$ref": "#/backend/entities/Receipt"
          },
          "description": "Stores receipt information. Each document represents a single receipt for a sale or purchase.",
          "params": [
            {
              "name": "receiptId",
              "description": "The unique identifier for the receipt."
            }
          ]
        }
      },
      {
        "path": "/expenses/{expenseId}",
        "definition": {
          "entityName": "Expense",
          "schema": {
            "$ref": "#/backend/entities/Expense"
          },
          "description": "Stores expense information. Each document represents a single expense incurred by SK Traders.",
          "params": [
            {
              "name": "expenseId",
              "description": "The unique identifier for the expense."
            }
          ]
        }
      },
      {
        "path": "/exports/{exportId}",
        "definition": {
          "entityName": "Export",
          "schema": {
            "$ref": "#/backend/entities/Export"
          },
          "description": "Stores export order information. Each document represents a single export order.",
          "params": [
            {
              "name": "exportId",
              "description": "The unique identifier for the export order."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to reflect the core entities of the SK Traders application, focusing on simplicity and scalability. It uses hierarchical paths for ownership where applicable (e.g., sales, purchases and receipts related to a client). The structure uses top-level collections for main entities like `clients`, `products`, `stocks`, `sales`, `purchases`, `receipts`, `expenses`, and `exports`.  Since all users (Admin, Manager, Employee) will need to access most collections, role based access control (DBAC) will be managed via Spring Security on the backend rather than attempting complex security rules on Firestore.  The user collection is avoided since Firebase Auth handles authentication. No authorization context is denormalized into subcollections, as all role-based access will be managed on the server.  This simplifies security rules dramatically and prevents the need for authorization independence via denormalization in Firestore.\n\nQAPs are supported by structural segregation. Each collection represents a distinct entity type, enabling straightforward list operations and access control on the backend. The absence of authorization denormalization simplifies the process of securely listing and filtering documents based on user roles."
  }
}